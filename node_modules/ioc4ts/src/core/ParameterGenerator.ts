/**
 * ParameterGenerator 类
 * 
 * 用于生成方法参数定义的工具类
 * 
 * @author zhangbaili
 * @since 1.1.0-beta
*/

import ApplicationContext from './ApplicationContext'
import MethodDefinition from './MethodDefinition'

export default class ParameterGenerator {
    static generate(name: string | undefined, type: string) {
        return (ctor: any, methodName: string, parameterIndex: number) => {
            const beanFactory = ApplicationContext.getInstance().getBeanFactory()
    
            let beanDefinition = beanFactory.getBeanDefinitionByCtor(ctor)
            if(!beanDefinition) {
                beanDefinition = beanFactory.loadBeanDefinition(ctor)
            }
    
            let methodDefinition = beanDefinition.getMethods().get(methodName)
            if(!methodDefinition) {
                methodDefinition = new MethodDefinition(methodName)
                beanDefinition.appendMethod(methodName, methodDefinition)
            }
    
            methodDefinition.appendParameter(type, name, parameterIndex)
        }
    }
}